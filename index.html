<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <!-- Prevent crawling/indexing -->
    <meta name="robots" content="noindex, nofollow">

    <!-- Address Bar / Theme Colors -->
    <meta name="theme-color" content="#0f172a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Roberts Cup">

    <title>2025-26 Roberts Cup</title>

    <!-- Local Icons from /images/web directory -->
    <link rel="icon" href="images/web/favicon.ico" sizes="any">
    <link rel="icon" type="image/png" sizes="192x192" href="images/web/icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="images/web/icon-512.png">
    <link rel="apple-touch-icon" href="images/web/apple-touch-icon.png">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Tailwind Config to Enforce Global Fonts -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Chivo', 'sans-serif'],
                        serif: ['"Patua One"', 'serif'],
                    },
                    colors: {
                        brand: '#0f172a', // Dark Slate
                    }
                }
            }
        }
    </script>

    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Custom Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,300;0,400;0,700;0,900;1,400&family=Patua+One&display=swap" rel="stylesheet">

    <style>
        /* PAGE MODE: Allow natural vertical scrolling */
        body {
            font-family: 'Chivo', sans-serif;
            /* Force the "overscroll" background to match the header color */
            background-color: #0f172a;
        }

        /* Ensure the app container covers the dark body with the light theme */
        #root > div {
            background-color: #f8fafc; /* Slate-50 */
            min-height: 100vh;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Patua One', serif;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            height: 10px;
            width: 8px;
            background: transparent;
        }
        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 8px;
            border: 2px solid #f1f5f9;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        /* Hide scrollbar for menu */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }

        /* Sticky Column Shadow */
        .sticky-col-shadow {
            box-shadow: 4px 0 8px -4px rgba(0, 0, 0, 0.1);
        }

        /* Z-INDEX HIERARCHY */
        th.sticky-left { z-index: 50 !important; }
        td.sticky-left { z-index: 40 !important; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script src="js/rc-config.js"></script>

    <script type="text/babel" src="js/rc-nav.js"></script>

    <script type="text/babel" src="js/rc-page-home.js"></script>

    
    <script type="text/babel" src="js/rc-page-standings.js"></script>
    <script type="text/babel" src="js/rc-page-picks.js"></script>

    <script type="text/babel" src="js/rc-page-race.js"></script>

    <script type="text/babel" src="js/rc-page-badges.js"></script>

<script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- CONFIGURATION + HELPERS (loaded from /js/rc-config.js) ---
        const { SCHEDULE_URL, PICKS_URL, HISTORY_URL, parseCSV, csvToJson } = window.RC;

        // --- COMPONENTS ---

        const LoadingSpinner = ({ text }) => (
            <div className="flex flex-col items-center justify-center min-h-screen text-gray-500 bg-white">
                <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-900 mb-4"></div>
                <p className="font-medium text-blue-900">{text}</p>
            </div>
        );

        const ErrorMessage = ({ message }) => (
            <div className="flex items-center justify-center min-h-screen bg-gray-100">
                <div className="bg-white border-l-4 border-red-500 text-red-700 px-6 py-4 rounded shadow-md max-w-lg">
                    <h3 className="font-bold mb-1">Data Error</h3>
                    <p className="text-sm">{message}</p>
                </div>
            </div>
        );

        const StatusPill = ({ pick, winner }) => {
            const safePick = pick ? pick.toString().trim() : "";
            const safeWinner = winner ? winner.toString().trim() : "";

            if (!safePick) {
                return <span className="text-gray-300">-</span>;
            }

            // Pending Game
            if (!safeWinner) {
                return (
                    <span className="inline-block px-2 py-0.5 rounded-lg border border-transparent text-xs font-medium bg-gray-50 text-gray-900 whitespace-nowrap">
                        {safePick}
                    </span>
                );
            }

            const isCorrect = safePick.toLowerCase() === safeWinner.toLowerCase();

            if (isCorrect) {
                return (
                    <span className="inline-flex items-center justify-center gap-1 px-2 py-0.5 rounded-lg border border-green-200 text-xs font-bold bg-green-100 text-green-800 whitespace-nowrap shadow-sm">
                        {safePick}
                        <svg className="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" strokeWidth="3">
                            <path strokeLinecap="round" strokeLinejoin="round" d="M5 13l4 4L19 7"></path>
                        </svg>
                    </span>
                );
            } else {
                return (
                    <span className="inline-block px-2 py-0.5 rounded-lg border border-transparent text-xs font-medium bg-red-50 text-red-400 line-through decoration-red-400 opacity-75 whitespace-nowrap">
                        {safePick}
                    </span>
                );
            }
        };

        // --- NAVIGATION (loaded from js/rc-nav.js) ---
        const { Navigation } = window.RC;

        // --- PAGES ---

        

        // 0. HOME PAGE (loaded from js/rc-page-home.js)
        window.RC.pages = window.RC.pages || {};
        const { HomePage, StandingsPage, PicksPage, RacePage, BadgesPage } = window.RC.pages;

        // 1. STANDINGS PAGE (loaded from js/rc-page-standings.js)

        // (StandingsPage extracted)

        // 2. PICKS PAGE (loaded from js/rc-page-picks.js)

        // (PicksPage extracted)

        // 3. RACE PAGE (loaded from js/rc-page-race.js)

        // (RacePage extracted)

        // 4. BADGES PAGE (loaded from js/rc-page-badges.js)

// 5. VERSUS PAGE
        const VersusPage = () => {
            const [players, setPlayers] = useState([]);
            const [schedule, setSchedule] = useState([]);
            const [picks, setPicks] = useState([]);
            const [selectedP1, setSelectedP1] = useState("");
            const [selectedP2, setSelectedP2] = useState("");
            const [loading, setLoading] = useState(true);

            useEffect(() => {
                const init = async () => {
                    try {
                        const [scheduleRes, picksRes] = await Promise.all([
                            fetch(SCHEDULE_URL),
                            fetch(PICKS_URL)
                        ]);
                        const scheduleText = await scheduleRes.text();
                        const picksText = await picksRes.text();

                        const scheduleData = csvToJson(scheduleText);
                        const sortedSchedule = scheduleData
                            .filter(g => g.Date && g.Time)
                            .sort((a, b) => new Date(`${a.Date} ${a.Time}`) - new Date(`${b.Date} ${b.Time}`));

                        const picksData = csvToJson(picksText).filter(p => p.Name);

                        setSchedule(sortedSchedule);
                        setPicks(picksData);

                        const names = picksData.map(p => p.Name).sort();
                        setPlayers(names);

                        if (names.length >= 2) {
                            // Randomize initial selection
                            let idx1 = Math.floor(Math.random() * names.length);
                            let idx2 = Math.floor(Math.random() * names.length);

                            // Ensure they are different
                            while (idx1 === idx2) {
                                idx2 = Math.floor(Math.random() * names.length);
                            }

                            setSelectedP1(names[idx1]);
                            setSelectedP2(names[idx2]);
                        }
                        setLoading(false);
                    } catch (e) {
                        console.error(e);
                        setLoading(false);
                    }
                };
                init();
            }, []);

            if (loading) return <LoadingSpinner text="Loading Rivalry Mode..." />;

            const getStats = (playerName) => {
                const p = picks.find(x => x.Name === playerName);
                if (!p) return { wins: 0, losses: 0, streak: 0 };
                let wins = 0; let losses = 0; let currentStreak = 0;
                schedule.forEach(g => {
                    if (g.Winner) {
                        const pick = p[g.Bowl];
                        if (pick && pick.toLowerCase() === g.Winner.toLowerCase()) {
                            wins++;
                            currentStreak = currentStreak >= 0 ? currentStreak + 1 : 1;
                        } else {
                            losses++;
                            currentStreak = currentStreak <= 0 ? currentStreak - 1 : -1;
                        }
                    }
                });
                return { wins, losses, streak: currentStreak };
            };

            const stats1 = getStats(selectedP1);
            const stats2 = getStats(selectedP2);
            const diffGames = [];
            const historyGames = [];
            let headToHead = { p1: 0, p2: 0 };

            if (selectedP1 && selectedP2) {
                const p1Data = picks.find(x => x.Name === selectedP1);
                const p2Data = picks.find(x => x.Name === selectedP2);
                schedule.forEach(g => {
                    const pick1 = p1Data[g.Bowl];
                    const pick2 = p2Data[g.Bowl];
                    if (pick1 && pick2 && pick1.toLowerCase() !== pick2.toLowerCase()) {
                        if (g.Winner) {
                            let winner = null;
                            if (pick1.toLowerCase() === g.Winner.toLowerCase()) { headToHead.p1++; winner = selectedP1; }
                            else if (pick2.toLowerCase() === g.Winner.toLowerCase()) { headToHead.p2++; winner = selectedP2; }
                            historyGames.push({ ...g, pick1, pick2, winner });
                        } else {
                            diffGames.push({ ...g, pick1, pick2 });
                        }
                    }
                });
            }

            return (
                <div className="flex flex-col min-h-screen bg-white font-sans pb-24">
                    <div className="bg-white pt-8 pb-4 px-4">
                        <div className="max-w-4xl mx-auto text-center">
                            <h2 className="text-3xl text-blue-900 font-bold mb-1">Rivalry Mode</h2>
                            <p className="text-gray-600 text-sm">Sibling rivalries? Settle the score.</p>
                        </div>
                    </div>

                    <div className="px-4 max-w-4xl mx-auto w-full flex flex-col gap-6">

                        <div className="flex items-center justify-center gap-4 bg-gray-50 p-4 rounded-xl border border-gray-200 shadow-sm">
                            <select
                                value={selectedP1}
                                onChange={(e) => setSelectedP1(e.target.value)}
                                className="bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 font-bold"
                            >
                                {players.map(p => <option key={p} value={p}>{p}</option>)}
                            </select>
                            <span className="text-gray-400 font-black italic">VS</span>
                            <select
                                value={selectedP2}
                                onChange={(e) => setSelectedP2(e.target.value)}
                                className="bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 font-bold"
                            >
                                {players.map(p => <option key={p} value={p}>{p}</option>)}
                            </select>
                        </div>

                        <div className="bg-slate-900 text-white rounded-xl shadow-lg p-6 text-center relative overflow-hidden">
                             <div className="absolute top-0 right-0 w-32 h-32 bg-blue-500/20 rounded-full blur-3xl -mr-10 -mt-10 pointer-events-none"></div>
                             <div className="absolute bottom-0 left-0 w-32 h-32 bg-red-500/20 rounded-full blur-3xl -ml-10 -mb-10 pointer-events-none"></div>

                            <h3 className="text-xs font-bold uppercase tracking-widest text-slate-400 mb-4 relative z-10">Head-to-Head (Differing Picks)</h3>
                            <div className="flex items-center justify-center gap-8 md:gap-16 relative z-10">
                                <div className="text-center">
                                    <div className="text-4xl md:text-6xl font-black">{headToHead.p1}</div>
                                    <div className="text-xs font-bold text-slate-400 mt-1">{selectedP1}</div>
                                </div>
                                <div className="text-2xl text-slate-600 font-serif italic">-</div>
                                <div className="text-center">
                                    <div className="text-4xl md:text-6xl font-black">{headToHead.p2}</div>
                                    <div className="text-xs font-bold text-slate-400 mt-1">{selectedP2}</div>
                                </div>
                            </div>
                        </div>

                        {/* Tale of the Tape */}
                        <div className="grid grid-cols-2 gap-4">
                            <div className="bg-white border border-gray-100 shadow-md rounded-xl p-4 text-center">
                                <div className="text-xs text-gray-400 font-bold uppercase mb-1">Total Wins</div>
                                <div className="text-2xl font-black text-gray-900">{stats1.wins}</div>
                            </div>
                            <div className="bg-white border border-gray-100 shadow-md rounded-xl p-4 text-center">
                                <div className="text-xs text-gray-400 font-bold uppercase mb-1">Total Wins</div>
                                <div className="text-2xl font-black text-gray-900">{stats2.wins}</div>
                            </div>

                            <div className="bg-white border border-gray-100 shadow-md rounded-xl p-4 text-center">
                                <div className="text-xs text-gray-400 font-bold uppercase mb-1">Current Streak</div>
                                <div className={`text-xl font-bold ${stats1.streak >= 0 ? 'text-green-600' : 'text-red-500'}`}>
                                    {stats1.streak > 0 ? `W${stats1.streak}` : `L${Math.abs(stats1.streak)}`}
                                </div>
                            </div>
                            <div className="bg-white border border-gray-100 shadow-md rounded-xl p-4 text-center">
                                <div className="text-xs text-gray-400 font-bold uppercase mb-1">Current Streak</div>
                                <div className={`text-xl font-bold ${stats2.streak >= 0 ? 'text-green-600' : 'text-red-500'}`}>
                                    {stats2.streak > 0 ? `W${stats2.streak}` : `L${Math.abs(stats2.streak)}`}
                                </div>
                            </div>
                        </div>

                        {/* History (Moved Up & Styled Green) */}
                        <div className="bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden">
                            <div className="bg-green-50 border-b border-green-100 px-4 py-3">
                                <h3 className="text-lg font-bold text-green-900 font-serif">Battle History</h3>
                            </div>
                            {historyGames.length > 0 ? (
                                <div className="divide-y divide-gray-100">
                                    {historyGames.reverse().map((g, idx) => {
                                        const p1Won = g.winner === selectedP1;
                                        const p2Won = g.winner === selectedP2;
                                        return (
                                            <div key={idx} className="p-4 flex items-center justify-between">
                                                 <div className={`text-right w-1/3 ${p1Won ? 'opacity-100' : 'opacity-40 grayscale'}`}>
                                                    <div className={`font-bold text-sm leading-tight ${p1Won ? 'text-green-700' : 'text-gray-900'}`}>{g.pick1}</div>
                                                    {p1Won && <div className="text-[10px] font-black text-green-600 uppercase">Winner</div>}
                                                </div>
                                                <div className="px-2 text-center w-1/3">
                                                    <div className="text-[10px] font-bold text-gray-400 uppercase tracking-wide mb-0.5">{g.Bowl}</div>
                                                    <div className="text-xs text-gray-300 font-bold">FINAL</div>
                                                </div>
                                                <div className={`text-left w-1/3 ${p2Won ? 'opacity-100' : 'opacity-40 grayscale'}`}>
                                                    <div className={`font-bold text-sm leading-tight ${p2Won ? 'text-green-700' : 'text-gray-900'}`}>{g.pick2}</div>
                                                    {p2Won && <div className="text-[10px] font-black text-green-600 uppercase">Winner</div>}
                                                </div>
                                            </div>
                                        );
                                    })}
                                </div>
                            ) : (
                                <div className="p-8 text-center text-gray-400 text-sm italic">
                                    No battles fought yet.
                                </div>
                            )}
                        </div>

                        {/* The Battleground (Moved Down) */}
                        <div className="bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden mb-8">
                            <div className="bg-red-50 border-b border-red-100 px-4 py-3">
                                <h3 className="text-lg font-bold text-red-900 font-serif">The Battleground</h3>
                                <p className="text-xs text-red-700">Upcoming games where you picked differently.</p>
                            </div>
                            {diffGames.length > 0 ? (
                                <div className="divide-y divide-gray-100">
                                    {diffGames.map((g, idx) => (
                                        <div key={idx} className="p-4 flex items-center justify-between">
                                            <div className="text-right w-1/3">
                                                <div className="font-bold text-gray-900 text-sm leading-tight">{g.pick1}</div>
                                                <div className="text-[10px] text-gray-400 font-bold">{selectedP1}</div>
                                            </div>
                                            <div className="px-2 text-center w-1/3">
                                                <div className="text-[10px] font-bold text-gray-400 uppercase tracking-wide mb-0.5">{g.Bowl}</div>
                                                <div className="text-xs font-medium text-red-500 bg-red-50 px-2 py-0.5 rounded-full inline-block">vs</div>
                                            </div>
                                            <div className="text-left w-1/3">
                                                <div className="font-bold text-gray-900 text-sm leading-tight">{g.pick2}</div>
                                                <div className="text-[10px] text-gray-400 font-bold">{selectedP2}</div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            ) : (
                                <div className="p-8 text-center text-gray-400 text-sm italic">
                                    No upcoming battles. You agree on everything!
                                </div>
                            )}
                        </div>

                    </div>
                </div>
            );
        };

        // 6. SIMULATOR PAGE (NEW)
        const SimulatorPage = () => {
            const [loading, setLoading] = useState(true);
            const [schedule, setSchedule] = useState([]);
            const [picks, setPicks] = useState([]);
            const [simulatedWinners, setSimulatedWinners] = useState({});

            useEffect(() => {
                const init = async () => {
                    try {
                        const [scheduleRes, picksRes] = await Promise.all([
                            fetch(SCHEDULE_URL),
                            fetch(PICKS_URL)
                        ]);
                        const scheduleText = await scheduleRes.text();
                        const picksText = await picksRes.text();

                        const scheduleData = csvToJson(scheduleText);
                        // Filter for UNPLAYED games (no winner yet) for the toggles
                        const unplayed = scheduleData.filter(g => !g.Winner && g.Bowl && g["Team 1"]);
                        // Sort by date/time
                        unplayed.sort((a, b) => new Date(`${a.Date} ${a.Time}`) - new Date(`${b.Date} ${b.Time}`));

                        const picksData = csvToJson(picksText).filter(p => p.Name);

                        setSchedule(scheduleData); // Need full schedule for calculations
                        setPicks(picksData);
                        setLoading(false);
                    } catch (e) {
                        console.error(e);
                        setLoading(false);
                    }
                };
                init();
            }, []);

            const toggleWinner = (bowl, team) => {
                setSimulatedWinners(prev => {
                    const next = { ...prev };
                    if (next[bowl] === team) {
                        delete next[bowl]; // Toggle off if already selected
                    } else {
                        next[bowl] = team;
                    }
                    return next;
                });
            };

            const resetSimulation = () => {
                setSimulatedWinners({});
            };

            // Calculate Projected Standings based on REAL winners + SIMULATED winners
            const projectedStandings = useMemo(() => {
                if (picks.length === 0) return [];

                return picks.map(player => {
                    let wins = 0;
                    schedule.forEach(game => {
                        const realWinner = game.Winner;
                        const simWinner = simulatedWinners[game.Bowl];

                        // Use simulated winner if no real winner exists
                        const winnerToUse = realWinner || simWinner;

                        if (winnerToUse) {
                            const pick = player[game.Bowl];
                            if (pick && pick.toLowerCase() === winnerToUse.toLowerCase()) {
                                wins++;
                            }
                        }
                    });
                    return { name: player.Name, wins };
                }).sort((a, b) => b.wins - a.wins); // Sort descending
            }, [picks, schedule, simulatedWinners]);

            if (loading) return <LoadingSpinner text="Booting up The Oracle..." />;

            const unplayedGames = schedule.filter(g => !g.Winner && g.Bowl && g["Team 1"]).sort((a, b) => new Date(`${a.Date} ${a.Time}`) - new Date(`${b.Date} ${b.Time}`));

            return (
                <div className="flex flex-col min-h-screen bg-white font-sans pb-24">
                    <div className="bg-white pt-8 pb-4 px-4">
                        <div className="max-w-4xl mx-auto text-center">
                            <h2 className="text-3xl text-blue-900 font-bold mb-1">The Simulator</h2>
                            <p className="text-gray-600 text-sm">Choose your destiny and predict the future.</p>
                        </div>
                    </div>

                    {/* Projected Leaderboard (Sticky) */}
                    <div className="sticky top-16 z-40 bg-white/95 backdrop-blur-sm border-b border-gray-100 shadow-sm px-4 pb-2 pt-2">
                        <div className="bg-slate-900 text-white rounded-xl p-4 shadow-lg mb-2">
                             <div className="flex justify-between items-center mb-2">
                                <h3 className="text-xs font-bold uppercase tracking-widest text-yellow-400">Projected Leaderboard</h3>
                                <button onClick={resetSimulation} className="text-[10px] bg-white/10 hover:bg-white/20 px-2 py-1 rounded text-white font-bold transition-colors">Reset All</button>
                             </div>
                             <div className="overflow-x-auto no-scrollbar pb-2">
                                 <div className="flex gap-4 w-fit mx-auto">
                                     {projectedStandings.slice(0, 10).map((p, idx) => (
                                         <div key={p.name} className="flex flex-col items-center justify-center flex-shrink-0 w-16">
                                             <span className="text-2xl font-black w-full text-center">{p.wins}</span>
                                             <span className="text-[10px] font-bold text-slate-400 truncate w-full text-center">{p.name}</span>
                                         </div>
                                     ))}
                                 </div>
                             </div>
                        </div>
                    </div>

                    <div className="px-4 max-w-4xl mx-auto w-full pt-4 pb-8 space-y-4">
                         {unplayedGames.length === 0 ? (
                             <div className="text-center text-gray-500 py-12">No unplayed games left to simulate!</div>
                         ) : (
                             unplayedGames.map((game) => {
                                 const selected = simulatedWinners[game.Bowl];
                                 return (
                                    <div key={game.Bowl} className="bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden">
                                        <div className="bg-gray-50 px-4 py-2 border-b border-gray-100 flex justify-between items-center">
                                            <span className="text-xs font-bold text-gray-500 uppercase tracking-wide">{game.Bowl}</span>
                                            <span className="text-[10px] font-bold text-gray-400">{game.Date}</span>
                                        </div>
                                        <div className="p-4 flex items-center justify-between gap-4">
                                            <button
                                                onClick={() => toggleWinner(game.Bowl, game["Team 1"])}
                                                className={`flex-1 py-3 px-2 rounded-lg font-bold text-sm transition-all border-2 ${selected === game["Team 1"] ? 'bg-green-600 text-white border-green-600 shadow-md transform scale-[1.02]' : 'bg-white text-gray-700 border-gray-200 hover:border-green-300'}`}
                                            >
                                                {game["Team 1"]}
                                            </button>
                                            <span className="text-gray-300 font-serif italic text-xs">vs</span>
                                             <button
                                                onClick={() => toggleWinner(game.Bowl, game["Team 2"])}
                                                className={`flex-1 py-3 px-2 rounded-lg font-bold text-sm transition-all border-2 ${selected === game["Team 2"] ? 'bg-green-600 text-white border-green-600 shadow-md transform scale-[1.02]' : 'bg-white text-gray-700 border-gray-200 hover:border-green-300'}`}
                                            >
                                                {game["Team 2"]}
                                            </button>
                                        </div>
                                    </div>
                                 );
                             })
                         )}
                    </div>
                </div>
            );
        };

        // 7. SCOUTING REPORT PAGE
                const ScoutingReportPage = () => {
                    const [selectedPlayer, setSelectedPlayer] = useState("");
                    const [players, setPlayers] = useState([]);
                    const [schedule, setSchedule] = useState([]);
                    const [picks, setPicks] = useState([]);
                    const [history, setHistory] = useState([]);
                    const [loading, setLoading] = useState(true);

                    // TEAM DATA FROM CSV
                    // Reference: School Export - Teams.csv
                    const TEAM_DATA = {
                        "Ohio State": { hex: "#BB0000", image: "images/helmets/OhioState.gif", nickname: "Buckeyes" },
                        "Georgia": { hex: "#BA0C2F", image: "images/helmets/Georgia.gif", nickname: "Bulldogs" },
                        "Texas Tech": { hex: "#CC0000", image: "images/helmets/TexasTech.gif", nickname: "Red Raiders" },
                        "Oregon": { hex: "#154734", image: "images/helmets/Oregon.gif", nickname: "Ducks" },
                        "Texas A&M": { hex: "#500000", image: "images/helmets/TexasAM.gif", nickname: "Aggies" },
                        "James Madison": { hex: "#450084", image: "images/helmets/JamesMadison.gif", nickname: "Dukes" },
                        "Alabama": { hex: "#8E001C", image: "images/helmets/Alabama.gif", nickname: "Crimson Tide" },
                        "Oklahoma": { hex: "#841617", image: "images/helmets/Oklahoma.gif", nickname: "Sooners" },
                        "Indiana": { hex: "#990000", image: "images/helmets/Indiana.gif", nickname: "Hoosiers" },
                        "Tulane": { hex: "#006747", image: "images/helmets/Tulane.gif", nickname: "Green Wave" },
                        "Ole Miss": { hex: "#182B49", image: "images/helmets/OleMiss.gif", nickname: "Rebels" },
                        "Miami (FL)": { hex: "#F47321", image: "images/helmets/MiamiFL.gif", nickname: "Hurricanes" }
                    };

                    useEffect(() => {
                        const init = async () => {
                            try {
                                const [schedRes, picksRes, histRes] = await Promise.all([
                                    fetch(SCHEDULE_URL), fetch(PICKS_URL), fetch(HISTORY_URL)
                                ]);
                                const schedText = await schedRes.text();
                                const picksText = await picksRes.text();
                                const histText = await histRes.text();

                                const sData = csvToJson(schedText);
                                const pData = csvToJson(picksText).filter(p => p.Name);
                                const hData = csvToJson(histText);

                                setSchedule(sData);
                                setPicks(pData);
                                setHistory(hData);

                                const names = pData.map(p => p.Name).sort();
                                setPlayers(names);
                                if (names.length > 0) setSelectedPlayer(names[0]);

                                setLoading(false);
                            } catch (e) { console.error(e); setLoading(false); }
                        };
                        init();
                    }, []);

                    if (loading) return <LoadingSpinner text="Scouting players..." />;

                    // --- CALCULATIONS ---
                    const calculateStats = (player) => {
                        if (!player) return null;
                        const pData = picks.find(p => p.Name === player);
                        if (!pData) return null;

                        // 1. Current Rank & Wins
                        const leaderboard = picks.map(p => {
                            let w = 0;
                            schedule.forEach(g => {
                                if (g.Winner && p[g.Bowl] && p[g.Bowl].toLowerCase() === g.Winner.toLowerCase()) w++;
                            });
                            return { name: p.Name, wins: w };
                        }).sort((a,b) => b.wins - a.wins);

                        // Calculate Rank with Ties logic
                        let currentRank = 1;
                        for (let i = 0; i < leaderboard.length; i++) {
                            if (i > 0 && leaderboard[i].wins < leaderboard[i - 1].wins) {
                                currentRank = i + 1;
                            }
                            leaderboard[i].rank = currentRank;

                            const prev = leaderboard[i-1];
                            const next = leaderboard[i+1];
                            leaderboard[i].isTied = (prev && prev.wins === leaderboard[i].wins) || (next && next.wins === leaderboard[i].wins);
                        }

                        const playerEntry = leaderboard.find(p => p.name === player);
                        const rank = playerEntry.rank;
                        const wins = playerEntry.wins;
                        const isTied = playerEntry.isTied;

                        // 2. Past Greatness (History)
                        const pastWinsData = history.filter(h => h.Winner && h.Winner.trim().toLowerCase() === player.toLowerCase());
                        const titles = pastWinsData.length;
                        const titleYears = pastWinsData.map(h => h.Year).sort().join(', ');

                        // 3. Situationals
                        const getWinStats = (filterFn) => {
                            const games = schedule.filter(g => g.Winner && filterFn(g));
                            if (games.length === 0) return { pct: 0, wins: 0, total: 0 };
                            let w = 0;
                            games.forEach(g => {
                                if (pData[g.Bowl] && pData[g.Bowl].toLowerCase() === g.Winner.toLowerCase()) w++;
                            });
                            return { pct: Math.round((w / games.length) * 100), wins: w, total: games.length };
                        };

                        const getTimeHour = (g) => {
                            if (!g.Time) return null;
                            const timeStr = g.Time.trim().toUpperCase();
                            let [timePart, modifier] = timeStr.split(' ');
                            if (!modifier) {
                                 if (timeStr.includes('PM')) { modifier = 'PM'; timePart = timeStr.replace('PM',''); }
                                 else if (timeStr.includes('AM')) { modifier = 'AM'; timePart = timeStr.replace('AM',''); }
                            }
                            let [hours, minutes] = timePart.split(':').map(Number);
                            if (modifier === 'PM' && hours !== 12) hours += 12;
                            if (modifier === 'AM' && hours === 12) hours = 0;
                            return hours;
                        };

                        const cfp = getWinStats(g => g.CFP);
                        const b1g = getWinStats(g => g.B1G);
                        const sec = getWinStats(g => g.SEC);

                        const morning = getWinStats(g => {
                            const h = getTimeHour(g);
                            return h !== null && h < 12;
                        });
                        const afternoon = getWinStats(g => {
                            const h = getTimeHour(g);
                            return h !== null && h >= 12 && h < 19;
                        });
                        const night = getWinStats(g => {
                            const h = getTimeHour(g);
                            return h !== null && h >= 19;
                        });

                        const espn = getWinStats(g => g.Network && g.Network.toUpperCase().includes('ESPN'));
                        const abc = getWinStats(g => g.Network && g.Network.toUpperCase().includes('ABC'));
                        const fox = getWinStats(g => g.Network && g.Network.toUpperCase().includes('FOX'));
                        const cbs = getWinStats(g => g.Network && g.Network.toUpperCase().includes('CBS'));
                        const tnt = getWinStats(g => g.Network && g.Network.toUpperCase().includes('TNT'));

                        // 4. Maverick Rating
                        let maverickScore = 0;
                        let totalGames = 0;
                        schedule.forEach(g => {
                            if (!g.Bowl) return;
                            const myPick = pData[g.Bowl];
                            if (!myPick) return;

                            const counts = {};
                            picks.forEach(p => {
                                const pp = p[g.Bowl];
                                if (pp) counts[pp] = (counts[pp] || 0) + 1;
                            });
                            let maxC = 0; let majority = null;
                            Object.entries(counts).forEach(([pick, count]) => {
                                if (count > maxC) { maxC = count; majority = pick; }
                            });

                            totalGames++;
                            if (myPick !== majority) maverickScore++;
                        });
                        const maverickPct = totalGames > 0 ? Math.round((maverickScore / totalGames) * 100) : 0;

                        // 5. Nemesis & BFF
                        let maxDiff = -1; let nemesis = "-";
                        let maxSame = -1; let bff = "-";

                        picks.forEach(p => {
                            if (p.Name === player) return;
                            let diff = 0; let same = 0;
                            schedule.forEach(g => {
                                const myP = pData[g.Bowl];
                                const theirP = p[g.Bowl];
                                if (myP && theirP) {
                                    if (myP !== theirP) diff++;
                                    else same++;
                                }
                            });
                            if (diff > maxDiff) { maxDiff = diff; nemesis = p.Name; }
                            if (same > maxSame) { maxSame = same; bff = p.Name; }
                        });

                        // 6. Streaks Calculation
                        const completedGames = schedule
                            .filter(g => g.Winner && g.Date && g.Time)
                            .sort((a, b) => new Date(`${a.Date} ${a.Time}`) - new Date(`${b.Date} ${b.Time}`));

                        let currentStreak = 0;
                        let maxWinStreak = 0;
                        let maxLossStreak = 0;
                        let tempWin = 0;
                        let tempLoss = 0;

                        completedGames.forEach(g => {
                            const pick = pData[g.Bowl];
                            const winner = g.Winner;

                            if (pick && pick.toLowerCase() === winner.toLowerCase()) {
                                tempWin++;
                                if (tempWin > maxWinStreak) maxWinStreak = tempWin;
                                tempLoss = 0;
                                currentStreak = currentStreak >= 0 ? currentStreak + 1 : 1;
                            } else {
                                tempLoss++;
                                if (tempLoss > maxLossStreak) maxLossStreak = tempLoss;
                                tempWin = 0;
                                currentStreak = currentStreak <= 0 ? currentStreak - 1 : -1;
                            }
                        });

                        // 7. Ceiling Tracker Logic
                        const totalGameCount = schedule.filter(g => g.Bowl && g["Team 1"]).length;
                        const unplayedCount = schedule.filter(g => g.Bowl && g["Team 1"] && !g.Winner).length;
                        const maxPotential = wins + unplayedCount;
                        const leaderWins = Math.max(...leaderboard.map(p => p.wins));

                        // 8. Signature Win Logic
                        let bestWin = null;
                        let minWinners = Infinity;

                        schedule.forEach(g => {
                            if (!g.Winner) return;
                            const myPick = pData[g.Bowl];
                            if (myPick && myPick.toLowerCase() === g.Winner.toLowerCase()) {
                                let gameWinnerCount = 0;
                                picks.forEach(p => {
                                    const theirPick = p[g.Bowl];
                                    if (theirPick && theirPick.toLowerCase() === g.Winner.toLowerCase()) {
                                        gameWinnerCount++;
                                    }
                                });

                                if (gameWinnerCount < minWinners) {
                                    minWinners = gameWinnerCount;
                                    bestWin = {
                                        bowl: g.Bowl,
                                        team: g.Winner,
                                        count: gameWinnerCount
                                    };
                                }
                            }
                        });

                        return { rank, isTied, wins, titles, titleYears, cfp, b1g, sec, morning, afternoon, night, espn, abc, fox, cbs, tnt, maverickPct, nemesis, bff,
                                 champ: pData["National Championship"], tiebreaker: pData["Tiebreaker Score"],
                                 currentStreak, maxWinStreak, maxLossStreak,
                                 maxPotential, totalGameCount, leaderWins, bestWin };
                    };

                    const stats = calculateStats(selectedPlayer);

                    // Helper component for Team Card
                    const ChampCard = ({ teamName }) => {
                        // Remove seed from name for lookup (e.g. "#5 Indiana" -> "Indiana")
                        // And trim just in case
                        const cleanName = teamName ? teamName.replace(/#\d+\s*/g, '').trim() : "";

                        // Lookup data from constant (case-insensitive key check if needed, but strict here)
                        const data = TEAM_DATA[cleanName];

                        // If not found in our list, use generic fallback
                        if (!data) {
                            return (
                                 <div className="bg-white rounded-xl border border-gray-200 shadow-sm p-4 relative overflow-hidden">
                                    <div className="text-xs font-bold text-gray-400 uppercase mb-1 relative z-10">National Championship Pick</div>
                                    <div className="text-2xl font-black text-gray-900 truncate relative z-10">{teamName || "-"}</div>
                                    <div className="absolute right-[-10px] bottom-[-10px] text-6xl opacity-5 pointer-events-none">üèÜ</div>
                                </div>
                            );
                        }

                        return (
                            <div
                                className="rounded-xl shadow-md p-4 relative overflow-hidden border-l-4"
                                style={{
                                    backgroundColor: 'white',
                                    borderColor: data.hex,
                                }}
                            >
                                 {/* Background Tint */}
                                 <div className="absolute inset-0 opacity-5" style={{ backgroundColor: data.hex }}></div>

                                 <div className="flex justify-between items-center relative z-10">
                                    <div>
                                        <div className="text-xs font-bold uppercase mb-1" style={{ color: data.hex }}>National Championship Pick</div>
                                        <div className="text-3xl font-black text-gray-900 leading-none">{cleanName}</div>
                                        <div className="text-sm font-bold text-gray-400 mt-1">{data.nickname}</div>
                                    </div>
                                    <div className="flex-shrink-0 w-20 h-20 -mr-2">
                                        <img
                                            src={data.image}
                                            alt={cleanName}
                                            className="w-full h-full object-contain drop-shadow-md transform hover:scale-110 transition-transform duration-300"
                                        />
                                    </div>
                                 </div>
                            </div>
                        );
                    };

                    return (
                        <div className="flex flex-col min-h-screen bg-white font-sans pb-24">
                             <div className="bg-white pt-8 pb-4 px-4">
                                <div className="max-w-4xl mx-auto text-center">
                                    <h2 className="text-3xl text-blue-900 font-bold mb-1">Scouting Report</h2>
                                    <p className="text-gray-600 text-sm">Deep dive analytics into your favorite people.</p>
                                </div>
                            </div>

                            <div className="px-4 max-w-xl mx-auto w-full flex flex-col gap-6">
                                {/* Selector */}
                                <div className="relative">
                                    <select
                                        value={selectedPlayer}
                                        onChange={(e) => setSelectedPlayer(e.target.value)}
                                        className="appearance-none bg-white border border-gray-300 text-gray-900 text-lg rounded-xl focus:ring-blue-500 focus:border-blue-500 block w-full p-4 font-bold shadow-sm text-center"
                                    >
                                        {players.map(p => <option key={p} value={p}>{p}</option>)}
                                    </select>
                                    <div className="pointer-events-none absolute inset-y-0 right-0 flex items-center px-4 text-gray-500">
                                        <svg className="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/></svg>
                                    </div>
                                </div>

                                {stats && (
                                                            <>
                                                                {/* Top Card */}
                                                                <div className="bg-slate-900 text-white rounded-2xl p-6 shadow-xl relative overflow-hidden">
                                                                    <div className="absolute top-0 right-0 w-32 h-32 bg-blue-500/20 rounded-full blur-3xl -mr-10 -mt-10 pointer-events-none"></div>
                                                                    <div className="flex justify-between items-center mb-6 relative z-10">
                                                                        <div className="text-left">
                                                                            <div className="text-sm text-slate-400 font-bold uppercase tracking-widest">Current Rank</div>
                                                                            <div className="text-5xl font-black text-white">
                                                                                {stats.isTied ? "T-" : ""}{stats.rank}
                                                                            </div>
                                                                        </div>
                                                                        <div className="text-right">
                                                                            <div className="text-sm text-slate-400 font-bold uppercase tracking-widest">Wins</div>
                                                                            <div className="text-5xl font-black text-yellow-400">{stats.wins}</div>
                                                                        </div>
                                                                    </div>

                                                                    {/* PAST GREATNESS BADGE - Fixed Height Container */}
                                                                    <div className="min-h-[80px] flex items-center">
                                                                        {stats.titles > 0 ? (
                                                                            <div className="bg-gradient-to-r from-yellow-500/20 to-amber-500/20 border border-yellow-500/30 rounded-lg p-3 flex items-center gap-3 relative z-10 w-full">
                                                                                <div className="text-2xl flex-shrink-0">üèÜ</div>
                                                                                <div>
                                                                                    <div className="text-xs font-bold text-yellow-400 uppercase tracking-widest">Past Greatness</div>
                                                                                    <div className="text-white font-bold">
                                                                                        {stats.titles}-Time Champion <span className="text-yellow-200/70 text-xs font-normal ml-1">({stats.titleYears})</span>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        ) : (
                                                                            <div className="bg-white/5 border border-white/10 rounded-lg p-3 flex items-center gap-3 relative z-10 opacity-50 w-full">
                                                                                <div className="text-2xl grayscale flex-shrink-0">üèÜ</div>
                                                                                <div>
                                                                                    <div className="text-xs font-bold text-slate-400 uppercase tracking-widest">Past Greatness</div>
                                                                                    <div className="text-slate-300 font-bold text-sm">Chasing first title</div>
                                                                                </div>
                                                                            </div>
                                                                        )}
                                                                    </div>
                                                                </div>

                                                                {/* Ceiling Tracker */}
                                                                <div className="bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden">
                                                                    <div className="bg-gray-50 border-b border-gray-200 px-4 py-3 flex justify-between items-center">
                                                                        <h3 className="text-lg font-bold text-gray-900 font-serif">Ceiling Tracker</h3>
                                                                        <span className="text-sm font-bold text-blue-600">{stats.maxPotential} Max Wins</span>
                                                                    </div>
                                                                    <div className="p-5">
                                                                        <div className="relative h-6 bg-gray-100 rounded-full w-full overflow-hidden mb-2">
                                                                            {/* Current Wins */}
                                                                            <div
                                                                                className="absolute top-0 bottom-0 left-0 bg-blue-600 transition-all duration-1000 z-10"
                                                                                style={{ width: `${(stats.wins / stats.totalGameCount) * 100}%` }}
                                                                            ></div>
                                                                            {/* Potential Wins */}
                                                                            <div
                                                                                className="absolute top-0 bottom-0 left-0 bg-blue-200 transition-all duration-1000"
                                                                                style={{ width: `${(stats.maxPotential / stats.totalGameCount) * 100}%` }}
                                                                            ></div>
                                                                            {/* Leader Line */}
                                                                            <div
                                                                                className="absolute top-0 bottom-0 w-0.5 bg-red-500 z-20 shadow-[0_0_8px_rgba(239,68,68,0.6)]"
                                                                                style={{ left: `${(stats.leaderWins / stats.totalGameCount) * 100}%` }}
                                                                            ></div>
                                                                        </div>
                                                                        <div className="flex justify-between text-xs font-bold text-gray-400 uppercase tracking-wide">
                                                                            <span>Current: {stats.wins}</span>
                                                                            <span className="text-red-500">Leader: {stats.leaderWins}</span>
                                                                        </div>
                                                                    </div>
                                                                </div>

                                                                {/* NEW: Extravagant Vitals (Champ ONLY) */}
                                                                <div className="space-y-4">
                                                                    <ChampCard teamName={stats.champ} />
                                                                </div>

                                                                {/* Relationships (Small Cards) */}
                                                                <div className="grid grid-cols-2 gap-3">
                                                                    <div className="bg-white p-4 rounded-xl border border-gray-200 shadow-sm">
                                                                        <div className="flex justify-between items-center mb-1">
                                                                            <div className="text-xs font-bold text-gray-400 uppercase">Nemesis</div>
                                                                        </div>
                                                                        <div className="text-lg font-black text-red-600 truncate">{stats.nemesis}</div>
                                                                        <div className="text-[10px] text-gray-500 mt-0.5">Most differing picks</div>
                                                                    </div>
                                                                    <div className="bg-white p-4 rounded-xl border border-gray-200 shadow-sm">
                                                                        <div className="flex justify-between items-center mb-1">
                                                                            <div className="text-xs font-bold text-gray-400 uppercase">Best Friend</div>
                                                                        </div>
                                                                        <div className="text-lg font-black text-green-600 truncate">{stats.bff}</div>
                                                                        <div className="text-[10px] text-gray-500 mt-0.5">Most shared picks</div>
                                                                    </div>
                                                                </div>

                                                                {/* Streaks Card */}
                                                                <div className="bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden">
                                                                    <div className="bg-gray-50 border-b border-gray-200 px-4 py-3">
                                                                        <h3 className="text-lg font-bold text-gray-900 font-serif">Season Streaks</h3>
                                                                    </div>
                                                                    <div className="p-4 grid grid-cols-3 gap-2 text-center divide-x divide-gray-100">
                                                                        <div>
                                                                            <div className="text-xs font-bold text-gray-400 uppercase mb-1">Current</div>
                                                                            <div className={`text-xl font-black ${stats.currentStreak > 0 ? 'text-green-600' : stats.currentStreak < 0 ? 'text-red-600' : 'text-gray-400'}`}>
                                                                                {stats.currentStreak > 0 ? `W${stats.currentStreak}` : stats.currentStreak < 0 ? `L${Math.abs(stats.currentStreak)}` : '-'}
                                                                            </div>
                                                                        </div>
                                                                        <div>
                                                                            <div className="text-xs font-bold text-gray-400 uppercase mb-1">Longest Win</div>
                                                                            <div className="text-xl font-black text-green-600">
                                                                                W{stats.maxWinStreak}
                                                                            </div>
                                                                        </div>
                                                                        <div>
                                                                            <div className="text-xs font-bold text-gray-400 uppercase mb-1">Longest Loss</div>
                                                                            <div className="text-xl font-black text-red-600">
                                                                                L{stats.maxLossStreak}
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>

                                                                {/* Signature Win Card */}
                                                                {stats.bestWin && (
                                                                    <div className="bg-gradient-to-br from-indigo-50 to-blue-50 rounded-xl border border-indigo-100 shadow-sm p-5 relative overflow-hidden">
                                                                        <div className="absolute top-0 right-0 text-6xl opacity-10 pointer-events-none">üåü</div>
                                                                        <h3 className="text-xs font-bold text-indigo-400 uppercase tracking-widest mb-1">Signature Win</h3>
                                                                        <div className="text-lg font-black text-indigo-900 leading-tight mb-2">
                                                                            Picked {stats.bestWin.team} in the {stats.bestWin.bowl}
                                                                        </div>
                                                                        <div className="inline-block bg-white border border-indigo-200 text-indigo-600 text-xs font-bold px-2 py-1 rounded shadow-sm">
                                                                            {stats.bestWin.count === 1
                                                                                ? "Only player to pick this!"
                                                                                : `Only ${stats.bestWin.count} players picked this`}
                                                                        </div>
                                                                    </div>
                                                                )}

                                                                {/* Skills Breakdown */}
                                                                <div className="bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden">
                                                                    <div className="bg-gray-50 border-b border-gray-200 px-4 py-3">
                                                                        <h3 className="text-lg font-bold text-gray-900 font-serif">Performance Grades</h3>
                                                                    </div>
                                                                    <div className="p-5 space-y-4">
                                                                        <div>
                                                                            <div className="flex justify-between text-sm font-bold mb-1">
                                                                                <span className="text-yellow-700">Playoffs <span className="text-gray-400 font-normal ml-1">({stats.cfp.wins} of {stats.cfp.total})</span></span>
                                                                                <span className="text-yellow-900">{stats.cfp.pct}%</span>
                                                                            </div>
                                                                            <div className="w-full bg-gray-100 rounded-full h-2">
                                                                                <div className="bg-yellow-500 h-2 rounded-full" style={{ width: `${stats.cfp.pct}%` }}></div>
                                                                            </div>
                                                                        </div>
                                                                        <div>
                                                                            <div className="flex justify-between text-sm font-bold mb-1">
                                                                                <span className="text-indigo-900">Big Ten conference matchups <span className="text-gray-400 font-normal ml-1">({stats.b1g.wins} of {stats.b1g.total})</span></span>
                                                                                <span className="text-indigo-700">{stats.b1g.pct}%</span>
                                                                            </div>
                                                                            <div className="w-full bg-gray-100 rounded-full h-2">
                                                                                <div className="bg-indigo-500 h-2 rounded-full" style={{ width: `${stats.b1g.pct}%` }}></div>
                                                                            </div>
                                                                        </div>
                                                                        <div>
                                                                            <div className="flex justify-between text-sm font-bold mb-1">
                                                                                <span className="text-blue-900">SEC conference matchups <span className="text-gray-400 font-normal ml-1">({stats.sec.wins} of {stats.sec.total})</span></span>
                                                                                <span className="text-blue-700">{stats.sec.pct}%</span>
                                                                            </div>
                                                                            <div className="w-full bg-gray-100 rounded-full h-2">
                                                                                <div className="bg-blue-600 h-2 rounded-full" style={{ width: `${stats.sec.pct}%` }}></div>
                                                                            </div>
                                                                        </div>

                                                                        <div className="border-t border-gray-100 pt-4 space-y-4">
                                                                            <div>
                                                                                <div className="flex justify-between text-sm font-bold mb-1">
                                                                                    <span className="text-orange-900">Morning Games <span className="text-gray-400 font-normal ml-1">({stats.morning.wins} of {stats.morning.total})</span></span>
                                                                                    <span className="text-orange-700">{stats.morning.pct}%</span>
                                                                                </div>
                                                                                <div className="w-full bg-gray-100 rounded-full h-2">
                                                                                    <div className="bg-orange-400 h-2 rounded-full" style={{ width: `${stats.morning.pct}%` }}></div>
                                                                                </div>
                                                                            </div>
                                                                            <div>
                                                                                <div className="flex justify-between text-sm font-bold mb-1">
                                                                                    <span className="text-sky-900">Afternoon Games <span className="text-gray-400 font-normal ml-1">({stats.afternoon.wins} of {stats.afternoon.total})</span></span>
                                                                                    <span className="text-sky-700">{stats.afternoon.pct}%</span>
                                                                                </div>
                                                                                <div className="w-full bg-gray-100 rounded-full h-2">
                                                                                    <div className="bg-sky-500 h-2 rounded-full" style={{ width: `${stats.afternoon.pct}%` }}></div>
                                                                                </div>
                                                                            </div>
                                                                            <div>
                                                                                <div className="flex justify-between text-sm font-bold mb-1">
                                                                                    <span className="text-purple-900">Night Games <span className="text-gray-400 font-normal ml-1">({stats.night.wins} of {stats.night.total})</span></span>
                                                                                    <span className="text-purple-700">{stats.night.pct}%</span>
                                                                                </div>
                                                                                <div className="w-full bg-gray-100 rounded-full h-2">
                                                                                    <div className="bg-purple-600 h-2 rounded-full" style={{ width: `${stats.night.pct}%` }}></div>
                                                                                </div>
                                                                            </div>
                                                                        </div>

                                                                        <div className="border-t border-gray-100 pt-4 space-y-4">
                                                                            <div>
                                                                                <div className="flex justify-between text-sm font-bold mb-1">
                                                                                    <span className="text-red-900">ESPN <span className="text-gray-400 font-normal ml-1">({stats.espn.wins} of {stats.espn.total})</span></span>
                                                                                    <span className="text-red-700">{stats.espn.pct}%</span>
                                                                                </div>
                                                                                <div className="w-full bg-gray-100 rounded-full h-2">
                                                                                    <div className="bg-red-600 h-2 rounded-full" style={{ width: `${stats.espn.pct}%` }}></div>
                                                                                </div>
                                                                            </div>
                                                                            <div>
                                                                                <div className="flex justify-between text-sm font-bold mb-1">
                                                                                    <span className="text-gray-900">ABC <span className="text-gray-400 font-normal ml-1">({stats.abc.wins} of {stats.abc.total})</span></span>
                                                                                    <span className="text-gray-700">{stats.abc.pct}%</span>
                                                                                </div>
                                                                                <div className="w-full bg-gray-100 rounded-full h-2">
                                                                                    <div className="bg-gray-900 h-2 rounded-full" style={{ width: `${stats.abc.pct}%` }}></div>
                                                                                </div>
                                                                            </div>
                                                                            <div>
                                                                                <div className="flex justify-between text-sm font-bold mb-1">
                                                                                    <span className="text-blue-900">FOX <span className="text-gray-400 font-normal ml-1">({stats.fox.wins} of {stats.fox.total})</span></span>
                                                                                    <span className="text-blue-700">{stats.fox.pct}%</span>
                                                                                </div>
                                                                                <div className="w-full bg-gray-100 rounded-full h-2">
                                                                                    <div className="bg-blue-600 h-2 rounded-full" style={{ width: `${stats.fox.pct}%` }}></div>
                                                                                </div>
                                                                            </div>
                                                                            <div>
                                                                                <div className="flex justify-between text-sm font-bold mb-1">
                                                                                    <span className="text-sky-900">CBS <span className="text-gray-400 font-normal ml-1">({stats.cbs.wins} of {stats.cbs.total})</span></span>
                                                                                    <span className="text-sky-700">{stats.cbs.pct}%</span>
                                                                                </div>
                                                                                <div className="w-full bg-gray-100 rounded-full h-2">
                                                                                    <div className="bg-sky-500 h-2 rounded-full" style={{ width: `${stats.cbs.pct}%` }}></div>
                                                                                </div>
                                                                            </div>
                                                                            <div>
                                                                                <div className="flex justify-between text-sm font-bold mb-1">
                                                                                    <span className="text-pink-900">TNT <span className="text-gray-400 font-normal ml-1">({stats.tnt.wins} of {stats.tnt.total})</span></span>
                                                                                    <span className="text-pink-700">{stats.tnt.pct}%</span>
                                                                                </div>
                                                                                <div className="w-full bg-gray-100 rounded-full h-2">
                                                                                    <div className="bg-pink-600 h-2 rounded-full" style={{ width: `${stats.tnt.pct}%` }}></div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>

                                                                {/* Style Meter */}
                                                                <div className="bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden">
                                                                    <div className="bg-gray-50 border-b border-gray-200 px-4 py-3">
                                                                        <h3 className="text-lg font-bold text-gray-900 font-serif">Style Rating</h3>
                                                                    </div>
                                                                    <div className="p-5">
                                                                        <div className="flex justify-between items-center mb-2">
                                                                            <span className="text-sm font-bold text-gray-400 uppercase">üêë Sheep</span>
                                                                            <span className="text-sm font-bold text-gray-400 uppercase">Maverick ü§†</span>
                                                                        </div>
                                                                        <div className="relative h-4 bg-gray-100 rounded-full w-full overflow-hidden">
                                                                            <div className="absolute top-0 bottom-0 left-0 bg-blue-500/20 w-full"></div>
                                                                            <div
                                                                                className="absolute top-0 bottom-0 bg-blue-600 w-2 rounded-full shadow-md transition-all duration-500"
                                                                                style={{ left: `${stats.maverickPct}%` }}
                                                                            ></div>
                                                                        </div>
                                                                        <div className="text-center mt-2 text-sm font-bold text-gray-500">
                                                                            {stats.maverickPct < 20 ? "Follows the Herd" : stats.maverickPct > 40 ? "Lone Wolf" : "Balanced Picker"} ({stats.maverickPct}%)
                                                                        </div>
                                                                        <p className="text-xs text-gray-400 text-center mt-3 px-2 leading-relaxed">
                                                                            This rating measures how often a player picks with the majority consensus (Sheep) versus picking against the group (Maverick). A lower percentage means you tend to agree with everyone else; a higher percentage means you like to go it alone.
                                                                        </p>
                                                                    </div>
                                                                </div>
                                                            </>
                                                        )}
                            </div>
                        </div>
                    );
                };

        // 8. HISTORY PAGE
        const HistoryPage = () => {
            const [historyData, setHistoryData] = useState([]); const [loading, setLoading] = useState(true); const [error, setError] = useState(null);
            useEffect(() => {
                const fetchHistory = async () => {
                    try {
                        const response = await fetch(HISTORY_URL); if (!response.ok) throw new Error("Failed to fetch History data");
                        const text = await response.text(); const rawData = csvToJson(text);
                        const sortedAsc = rawData.filter(r => r.Year && r.Winner).sort((a, b) => parseInt(a.Year) - parseInt(b.Year));
                        const winCounts = {};
                        setHistoryData(sortedAsc.map(entry => {
                            const winner = entry.Winner.trim(); winCounts[winner] = (winCounts[winner] || 0) + 1;
                            return { ...entry, winNumber: winCounts[winner] };
                        }).reverse());
                    } catch (err) { console.error(err); setError(err.message); } finally { setLoading(false); }
                };
                fetchHistory();
            }, []);
            if (loading) return <LoadingSpinner text="Loading History..." />;
            if (error) return <ErrorMessage message={error} />;
            return (
                <div className="flex flex-col min-h-screen bg-white font-sans pb-24">
                    <div className="bg-white pt-8 pb-8 px-4"><div className="max-w-7xl mx-auto text-center"><h2 className="text-3xl text-blue-900 font-bold mb-1">Hall of Fame</h2><p className="text-gray-600 text-sm">The legends of the family pool.</p></div></div>
                    <div className="relative px-4 max-w-2xl mx-auto w-full"><div className="space-y-8">
                            {historyData.map((item, index) => (
                                <div key={index} className="relative flex items-center group">
                                    <div className="absolute left-6 md:left-8 -translate-x-1/2 w-10 h-10 md:w-12 md:h-12 bg-white border-4 border-blue-100 rounded-full flex items-center justify-center z-10 shadow-sm group-hover:scale-110 group-hover:border-yellow-400 transition-all duration-300">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="text-yellow-500"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></svg>
                                    </div>
                                    <div className="ml-16 md:ml-20 bg-white p-5 rounded-2xl shadow-sm border border-gray-100 w-full flex justify-between items-center relative overflow-hidden group-hover:shadow-md transition-shadow">
                                        <div className="absolute -right-2 -bottom-6 text-7xl md:text-8xl font-black text-gray-50 select-none z-0">{item.Year}</div>
                                        <div className="relative z-10"><div className="flex items-center gap-2 mb-1"><span className="text-xs font-bold text-blue-500 uppercase tracking-widest">Champion</span>{item.winNumber > 1 && (<span className="bg-yellow-100 text-yellow-700 text-[10px] font-black px-2 py-0.5 rounded-full uppercase tracking-wide border border-yellow-200 shadow-sm">{item.winNumber}-Time Winner</span>)}</div><h3 className="text-2xl md:text-3xl font-bold text-gray-800">{item.Winner}</h3></div>
                                        <div className="relative z-10 ml-4"><div className="bg-gray-50 px-3 py-1 md:px-4 md:py-2 rounded-lg border border-gray-100 text-center"><span className="text-lg md:text-xl font-bold text-blue-900 block leading-none">{item.Year}</span></div></div>
                                    </div>
                                </div>
                            ))}
                        </div></div>
                </div>
            );
        };

        const App = () => {
            const [activeTab, setActiveTab] = useState('home');
            return (
                <div className="min-h-screen bg-white pt-16">
                    <Navigation activeTab={activeTab} setActiveTab={setActiveTab} />
                    {activeTab === 'home' && <HomePage />}
                    {activeTab === 'standings' && <StandingsPage />}
                    {activeTab === 'picks' && <PicksPage />}
                    {activeTab === 'race' && <RacePage />}
                    {activeTab === 'badges' && <BadgesPage />}
                    {activeTab === 'versus' && <VersusPage />}
                    {activeTab === 'simulator' && <SimulatorPage />}
                    {activeTab === 'scouting' && <ScoutingReportPage />}
                    {activeTab === 'history' && <HistoryPage />}
                </div>
            );
        };
        const root = ReactDOM.createRoot(document.getElementById("root")); root.render(<App />);
    </script>
</body>
</html>
